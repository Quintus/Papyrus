\documentclass[a4paper,11pt]{article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This file is part of rdoc_pdf-latex.
% Copyright © 2011 Pegasus Alpha
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Variables used for the ERB template:
%
% babel_lang: Something like "ngerman", determines the babel language
%   to load
% doc_title:  Title of the documentation
% intro_text: Text for the first page, the file given via RDoc's -m option
% classes:    List of RDoc::ClassModule objects for all found classes.
% modules:    List of RDoc::ClassModule objects for all found modules.
% methods:    List of RDoc::MethodAttr objects for all found methods

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[<%= babel_lang %>]{babel} %Hyphenation, etc.
\usepackage[utf8]{inputenc} %Input encoding: UTF-8
\usepackage[T1]{fontenc} %Output encoding: T1
\usepackage{lmodern} %Pretty fonts for T1
\usepackage{textcomp} %Useful things like \textdegree
\usepackage[official]{eurosym} %Official \euro symbol
\usepackage{lastpage} %Get a reference on the last page
\usepackage{fancyhdr} %Headers and footers
%\usepackage{amsmath} %For math
%\usepackage{amsfonts} %Math fonts
%\usepackage[retainorgcmds]{IEEEtrantools} %For equations
%\usepackage{listings} %Syntax hightlighting
\usepackage{xcolor} %Colored text
%\usepackage{graphicx} %Graphics
\usepackage{titlesec} %Easily define new heading styles
\usepackage{titletoc} %For telling LaTeX where to put the new headings in the TOC
\usepackage[unicode=true,pdftex]{hyperref} %For hyperlinks

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% General information
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author{\LaTeX PDF generator for RDoc}
\title{<%= doc_title %>}
\date{\today}

%Generate TOC only till level 2
\setcounter{tocdepth}{2}
%Disable section numbering
\setcounter{secnumdepth}{-2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% New commands and environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TODO: Make this a LaTeX package?

%Module and Class headings
\makeatletter
%This is the string that is placed in front of
%a heading made with \classmodule. Set by the
%\class and \module commands.
\newcommand{\@cmidentstring}{}

%Heading for typesetting class and module names. The word
%preceding the actual name is contained in \@cmidentstring
%which should be cleared after the call to \classmodule.
\titleclass{\classmodule}{straight}[\section]
\titleformat{\classmodule}[hang]{\Large}
   {\themodule}{1em}{\textsc{\@cmidentstring}\,\bfseries}
\titlespacing{\classmodule}{0pt}{*1}{\baselineskip}
\newcounter{classmodule}
\renewcommand\theclassmodule{\thesection.\arabic{classmodule}}
\titlecontents{classmodule}[0pt]{}{%
  \thecontentslabel}{}{%
  \titlerule*[8pt]{.}\contentspage}

%Heading for class names
\newcommand{\class}[1]{\renewcommand{\@cmidentstring}{Class}%
  \classmodule{#1}%
  \renewcommand{\@cmidentstring}{}}

%Heading for module names
\newcommand{\module}[1]{\renewcommand{\@cmidentstring}{Module}%
  \classmodule{#1}%
  \renewcommand{\@cmidentstring}{}
}
\makeatother

%\makeatletter
%For user’s headings
%\titleclass{\headingI}{straight}[\part]
%\titleformat{\headingI}[hang]{\Large}{\theheadingI}{1em}{}
%\titlespacing{\headingI}{0pt}{*1}{\baselineskip}
%\newcounter{headingI}
%\renewcommand{\theheadingI}{\arabic{headingI}}
\newcommand{\headingI}[1]{\protect\subsection*{#1}}

%\titleclass{\headingII}{straight}[\headingI]
%\titleformat{\headingII}[hang]{\large\scshape}
%  {\theheadingII}{1em}{}
%\titlespacing{\headingII}{0pt}{*1}{\baselineskip}
%\newcounter{headingII}
%\renewcommand{\theheadingII}{\theheadingI.\arabic{headingII}}

\makeatletter
\newcommand{\headingII}[1]{\par\noindent\large\textsc{#1}%
\vspace{\baselineskip}\normalsize%
\@afterindentfalse\@afterheading}

\newcommand{\headingIII}[1]{\par\noindent\textsc{#1}%
\vspace{\baselineskip}\normalsize%
\@afterindentfalse\@afterheading}

\newcommand{\headingIV}[1]{\par\noindent\testsf{#1}%
\vspace{\baselineskip}\normalsize%
\@afterindentfalse\@afterheading}
\makeatother

%Code without specification
\newcommand{\code}[1]{\texttt{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Package-specific settings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% hyperref
\hypersetup{colorlinks=true,urlcolor=blue}
\hypersetup{pdfauthor={\LaTeX PDF generator for RDoc},pdftitle={<%= doc_title %>}}
\makeatletter
%Add the new heading levels we defined above to hyperref’s
%level hierarchy
\providecommand*{\toclevel@module}{2}
\providecommand*{\toclevel@class}{2}
%\renewcommand{\toclevel@subsection}{4}
%\renewcommand{\toclevel@subsubsection}{4}
%\renewcommand{\toclevel@paragraph}{5}
%\renewcommand{\toclevel@subparagraph}{6}
\makeatother

% fancyhdr
\pagestyle{fancy}
\fancyhf{} %Delete everything
\fancyhead[L]{<%= doc_title %>}
\fancyhead[R]{\thepage{} / \pageref*{LastPage}}
\setlength{\headheight}{14.5pt} %Otherwise LaTeX complains
\renewcommand{\headrulewidth}{0.4pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document start
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{titlepage}
  \begin{center}
    \Huge <%= doc_title %>
  \end{center}
  \begin{flushright}
    \rule{4.5cm}{0.1cm}\\
    \normalsize Generated \today\\
    \tiny by the PDF \LaTeX{} generator for RDoc
  \end{flushright}
\end{titlepage}

<%= intro_text %>

\clearpage
\hypersetup{linkcolor=black} %Red TOC looks absolutely awful
\tableofcontents
\hypersetup{linkcolor=red} %Restore original link color
\clearpage

\section{Classes and modules overview}

\begin{itemize}
<% classes_and_modules.each do |mod| %>
  \item \hyperref[<%= mod.latex_label %>]{<%= mod.latexized :full_name %>}
<% end %>
\end{itemize}
  
\section{Methods overview}

\begin{itemize}
<% methods.each do |meth| %>
\item  \hyperref[%
  <%= meth.latex_label %>%
  ]%
  {%
  <%= meth.latexized(:name_prefix) + meth.latexized(:name) %> (<%= meth.parent.latexized :full_name %>)%
  }
<% end %>
\end{itemize}

\clearpage

\section{Class and module reference}
<% classes_and_modules.each do |mod| %>
  \input{<%= render_module(mod) %>}\clearpage %Always start a new page for a new class/module
<% end %>

\end{document}
